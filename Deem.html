<!doctype html>
<html lang="ar" dir="rtl">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>For You — A Little Surprise</title>
	<style>
		:root{ --bg:#ffeef6; --accent:#ff6ea6; --envelope:#fff; --paper:#fff7f9; --shadow:rgba(0,0,0,0.12); --font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
		html,body{height:100%;margin:0;font-family:var(--font);background:linear-gradient(180deg,var(--bg),#fff);overflow:hidden}
		.bg{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden}
		.bg .float{position:absolute;opacity:0.95;will-change:transform}
		@keyframes drift {0%{transform:translateX(-10%) translateY(0) rotate(0)}50%{transform:translateX(10%) translateY(-8px) rotate(8deg)}100%{transform:translateX(-10%) translateY(0) rotate(0)}}
		.rain{position:fixed;inset:0;pointer-events:none;z-index:2}
		.petal{position:absolute;opacity:0.98}
		@keyframes fall{0%{transform:translateY(-10vh) rotate(0) translateX(0);opacity:0}10%{opacity:1}100%{transform:translateY(110vh) rotate(360deg) translateX(20vw);opacity:1}}
		.stage{position:relative;z-index:3;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:40px}
		.card-wrap{position:relative;width:360px;max-width:92vw}
		.envelope{position:relative;width:100%;height:220px;background:var(--envelope);border-radius:12px;box-shadow:0 12px 30px var(--shadow);overflow:visible;cursor:pointer;display:flex;align-items:center;justify-content:center}
		.flap{position:absolute;top:-6px;width:100%;height:60%;left:0;border-radius:12px;background:linear-gradient(180deg,#fff,#ffeef2);transform-origin:50% 0;transition:transform .45s cubic-bezier(.2,.9,.2,1);box-shadow:0 8px 20px rgba(0,0,0,0.06)}
		.envelope.open .flap{transform:rotateX(180deg) translateY(-18px)}
		.sticker{position:absolute;top:28px;left:50%;transform:translateX(-50%);width:64px;height:64px;border-radius:999px;background:linear-gradient(180deg,var(--accent),#c3354a);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:0 6px 18px rgba(0,0,0,0.12);transition:transform .25s}
		.paper{position:relative;width:90%;height:70%;background:var(--paper);border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06);display:flex;align-items:center;justify-content:center;padding:18px;opacity:0;transform:translateY(10px);transition:opacity .35s,transform .35s}
		.envelope.open .paper{opacity:1;transform:translateY(0)}
		#message{direction:rtl;text-align:right;line-height:1.6;color:#2b2b2b;white-space:pre-wrap}
		.controls{position:fixed;left:16px;bottom:16px;z-index:6;display:flex;gap:8px}
		.btn{background:rgba(255,255,255,0.9);border-radius:8px;padding:8px 12px;box-shadow:0 6px 16px rgba(0,0,0,0.08);cursor:pointer}
		#audioOverlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:7;background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,255,0.4))}
		#overlayPlay{background:var(--accent);color:#fff;padding:12px 18px;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,0.12);cursor:pointer}
		#ytFallback{position:fixed;right:16px;bottom:16px;background:rgba(255,255,255,0.95);padding:10px 12px;border-radius:8px;box-shadow:0 8px 20px rgba(0,0,0,0.08);z-index:8;display:none}

		/* Cute background hearts */
		.bg .heart{position:absolute;width:18px;height:18px;border-radius:6px;background:linear-gradient(180deg,#ffd6e8,#ff96c8);opacity:0.9;transform:translateY(0);will-change:transform,opacity}
		@keyframes floatUp {0%{transform:translateY(0) scale(0.9);opacity:0}10%{opacity:1}100%{transform:translateY(-110vh) scale(1.1);opacity:0}}

		/* Animated cat on envelope: container spans envelope; inner .walker moves across */
		#cat{position:absolute;left:0;top:-56px;width:100%;height:80px;z-index:12;pointer-events:none;overflow:visible}
		#cat svg{width:100%;height:100%;display:block;pointer-events:none}
		/* the visible cat (small) sits inside .walker and will travel across the #cat container */
		#cat .walker{position:absolute;left:0;top:0;width:96px;height:64px}
		@keyframes walkAcross {
			0%{transform:translateX(0) scaleX(1)}
			49%{transform:translateX(calc(100% - 96px)) scaleX(1)}
			50%{transform:translateX(calc(100% - 96px)) scaleX(-1)}
			100%{transform:translateX(0) scaleX(-1)}
		}
		@keyframes bob{0%{transform:translateY(0)}50%{transform:translateY(-3px)}100%{transform:translateY(0)}}
		@keyframes wag{0%{transform:rotate(0deg)}50%{transform:rotate(20deg)}100%{transform:rotate(0deg)}}
		#cat .walker{animation:walkAcross 6s linear infinite;transform-origin:center;will-change:transform}
		#cat .bob{animation: bob 1.2s ease-in-out infinite}
		#cat .tail{transform-origin:10px 48px;animation:wag 0.8s ease-in-out infinite}
		/* message date styling */
		#message .date{display:block;text-align:center;font-weight:700;font-size:1.05rem;margin-bottom:8px}
		#message .text{display:block;text-align:right}
	</style>
</head>
<body>
	<div class="bg" id="bg"></div>
	<div class="rain" id="rain"></div>
	<main class="stage">
		<div class="card-wrap">
			<div class="envelope" id="envelope" role="button" tabindex="0" aria-expanded="false" aria-label="فتح الظرف">
				<div class="flap"></div>
				<div class="sticker" id="sticker">❤</div>
						<div class="paper" id="paper"><div id="message" dir="rtl"><div class="date">4.12.2025</div><div class="text">تاريخ بداية حياة جديدة و جميله ان شاءالله مليانه لحظات حلوه, الله يجعلنا لبعض كما نحب و يجعلنا عند حسن الظن و اكثر ❤️</div></div></div>
			</div>
			<!-- animated cat walker sits on top of envelope -->
			<div id="cat" aria-hidden="true">
				<div class="walker">
					<!-- more natural-looking cat SVG: soft gray with shading, tail and paws -->
					<svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
					  <defs>
						<linearGradient id="gBody" x1="0" x2="0" y1="0" y2="1">
						  <stop offset="0%" stop-color="#f2f2f4"/>
						  <stop offset="100%" stop-color="#d8d8db"/>
						</linearGradient>
						<linearGradient id="gHead" x1="0" x2="0" y1="0" y2="1">
						  <stop offset="0%" stop-color="#ffffff"/>
						  <stop offset="100%" stop-color="#e9e9ea"/>
						</linearGradient>
					  </defs>
					  <g class="bob" transform="translate(8,4)">
						<!-- tail -->
						<path class="tail" d="M16 64 C8 54 6 42 22 36 C34 30 54 34 70 44" stroke="#bdbdbf" stroke-width="8" stroke-linecap="round" fill="none" />
						<!-- body -->
						<ellipse cx="96" cy="64" rx="56" ry="30" fill="url(#gBody)" />
						<!-- chest/marking -->
						<path d="M76 56 C84 72 108 76 126 66 C118 62 94 58 76 56 Z" fill="#ffffff" opacity="0.9" />
						<!-- head -->
						<circle cx="150" cy="44" r="28" fill="url(#gHead)" />
						<!-- ears -->
						<path d="M136 28 L126 12 L146 26 Z" fill="#e6e6e7" />
						<path d="M164 28 L174 12 L154 26 Z" fill="#e6e6e7" />
						<!-- eyes -->
						<ellipse cx="142" cy="42" rx="3.8" ry="4.8" fill="#2b1b1b" />
						<ellipse cx="158" cy="42" rx="3.8" ry="4.8" fill="#2b1b1b" />
						<!-- nose and mouth -->
						<path d="M150 50 Q152 54 156 50" stroke="#4a3a3b" stroke-width="1.6" fill="none" stroke-linecap="round" />
						<!-- whiskers -->
						<path d="M128 48 L142 48" stroke="#9a9a9b" stroke-width="1.2" />
						<path d="M158 48 L172 48" stroke="#9a9a9b" stroke-width="1.2" />
						<!-- paws -->
						<ellipse cx="74" cy="86" rx="8" ry="6" fill="#d0d0d2" />
						<ellipse cx="104" cy="86" rx="8" ry="6" fill="#d0d0d2" />
						<ellipse cx="134" cy="86" rx="8" ry="6" fill="#d0d0d2" />
					  </g>
					</svg>
				</div>
			</div>
		</div>
	</main>

	<!-- QR overlay (initial) -->
	<div id="qrOverlay" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9;background:rgba(255,255,255,0.95);flex-direction:column;padding:24px;gap:12px">
		<div style="text-align:center;max-width:92vw">
			<h2 style="margin:0 0 8px 0;color:#c32b45">امسحي الرمز QR لتشغيل الأغنية</h2>
			<img id="qrImg" alt="QR to song" style="width:220px;height:220px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.12);background:white" />
		</div>
		<button id="qrDoneBtn" class="btn" style="font-size:16px;padding:10px 18px">اذا شغلتي الأغنية اضغطي هنا</button>
	</div>
	<div id="ytContainer" style="position:fixed;left:-9999px;top:-9999px;width:1px;height:1px;overflow:hidden;display:none"></div>

	<script>
		(function(){
			const YT_ID = 'UGnHDuGFbj8';

						// leaf SVG generator (simple stylized leaf)
						function leafSVG(size=96, color1='#6bbf59', color2='#3a7a2a'){
								const ns='http://www.w3.org/2000/svg';
								const svg=document.createElementNS(ns,'svg'); svg.setAttribute('viewBox','0 0 64 64'); svg.setAttribute('width',size); svg.setAttribute('height',size);
								svg.innerHTML = `
										<defs>
											<linearGradient id="lg-${Math.random().toString(36).slice(2,7)}" x1="0" x2="1" y1="0" y2="1">
												<stop offset="0%" stop-color="${color1}" />
												<stop offset="100%" stop-color="${color2}" />
											</linearGradient>
										</defs>
										<g transform="translate(2,2)">
											<path d="M8 32 C20 8 44 8 56 32 C44 40 28 52 8 56 C10 44 2 36 8 32 Z" fill="url(#lg-0)" opacity="0.95" />
										</g>`;
								// fix gradient id reference
								svg.innerHTML = svg.innerHTML.replace(/lg-0/g, function(){ return 'lg-'+Math.random().toString(36).slice(2,7); });
								return svg;
						}

						// create drifting leaves instead of big roses
						const bg = document.getElementById('bg');
						const leafColors = [['#b7e4c7','#58a36a'], ['#d8f0d2','#4aa04a'], ['#9ad08a','#347a2d']];
						for(let i=0;i<12;i++){
								const el=document.createElement('div'); el.className='float';
								const s=40+Math.round(Math.random()*80);
								el.style.width=s+'px'; el.style.height=s+'px';
								el.style.left=(Math.random()*100)+'%'; el.style.top=(5+Math.random()*85)+'vh';
								el.style.opacity=0.6+Math.random()*0.35; el.style.transform=`rotate(${Math.random()*40-20}deg)`;
								el.style.animation=`drift ${14+Math.random()*18}s ease-in-out ${Math.random()*6}s infinite`;
								const colors = leafColors[Math.floor(Math.random()*leafColors.length)];
								el.appendChild(leafSVG(s, colors[0], colors[1]));
								bg.appendChild(el);
						}

			const rain = document.getElementById('rain'); const petalColors=['#ff8a95','#e57373','#b3001b']; function spawnPetal(){ const p=document.createElement('div'); p.className='petal'; const size=14+Math.round(Math.random()*32); p.style.left=(Math.random()*100)+'%'; p.style.top='-10vh'; p.style.width=size+'px'; p.style.height=size+'px'; p.style.animation=`fall ${5+Math.random()*6}s linear`; const c=petalColors[Math.floor(Math.random()*petalColors.length)]; p.innerHTML=`<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><path d="M32 8 C36 14 44 10 50 14 C40 18 46 26 42 34 C34 32 34 44 26 42 C28 34 20 28 22 20 C24 12 26 2 32 8 Z" fill="${c}"/></svg>`; rain.appendChild(p); setTimeout(()=>p.remove(),13000); }
			setInterval(spawnPetal, 550);

			// create small floating hearts in background for a cute look
			(function spawnHearts(){
				const bgEl = document.getElementById('bg');
				for(let i=0;i<10;i++){
					const h = document.createElement('div'); h.className='heart';
					const size = 10 + Math.round(Math.random()*20);
					h.style.width = size+'px'; h.style.height = size+'px';
					h.style.left = (Math.random()*100)+'%';
					h.style.top = (60+Math.random()*30)+'%';
					h.style.opacity = 0.6+Math.random()*0.4;
					h.style.borderRadius = (size/3)+'px';
					h.style.animation = 'floatUp ' + (8+Math.random()*12) + 's linear ' + (Math.random()*4) + 's forwards';
					bgEl.appendChild(h);
				}
			})();

						const envelope = document.getElementById('envelope'); const messageEl = document.getElementById('message');
						envelope.addEventListener('click', ()=>{ envelope.classList.toggle('open'); envelope.setAttribute('aria-expanded', String(envelope.classList.contains('open'))); playBackground(); });
			envelope.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); envelope.click(); } });
			window.setArabicMessage = function(txt){ messageEl.innerText = txt; };

						// add a cute pink cat SVG into the sticker
						(function addCatToSticker(){
								const sticker = document.getElementById('sticker');
								if(!sticker) return;
								sticker.innerHTML = '';
								const ns = 'http://www.w3.org/2000/svg';
								const svg = document.createElementNS(ns,'svg'); svg.setAttribute('viewBox','0 0 64 64'); svg.setAttribute('width','48'); svg.setAttribute('height','48');
								svg.innerHTML = `
									<g>
										<defs>
											<linearGradient id="catg" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stop-color="#ffd6e8"/><stop offset="100%" stop-color="#ff96c8"/></linearGradient>
										</defs>
										<circle cx="32" cy="32" r="30" fill="url(#catg)" />
										<path d="M20 30 C18 22 26 18 32 22 C38 18 46 22 44 30 C44 38 36 44 32 44 C28 44 20 38 20 30 Z" fill="#fff" opacity="0.9" />
										<circle cx="26" cy="30" r="3" fill="#3a1f2b" />
										<circle cx="38" cy="30" r="3" fill="#3a1f2b" />
										<path d="M28 38 Q32 42 36 38" stroke="#3a1f2b" stroke-width="2" fill="none" stroke-linecap="round" />
										<path d="M16 18 Q22 10 28 18" fill="#ffd6e8" />
										<path d="M48 18 Q42 10 36 18" fill="#ffd6e8" />
									</g>`;
								sticker.appendChild(svg);
						})();

			// QR overlay handling (link to song)
			const qrOverlay = document.getElementById('qrOverlay'); const qrImg = document.getElementById('qrImg'); const qrDone = document.getElementById('qrDoneBtn');
			const SONG_URL = 'https://www.youtube.com/watch?v=' + YT_ID;
			// Try Google Chart API for QR, fall back to manual fallback UI if blocked
			qrImg.src = 'https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl=' + encodeURIComponent(SONG_URL) + '&chld=L|1';
			qrImg.onerror = function(){
				// if QR image fails to load, replace overlay content with a visible link + open button (no copy)
				const parent = qrImg.parentElement;
				if(!parent) return;
				parent.innerHTML = '<div style="padding:8px"><p style="margin:0 0 8px 0;color:#c32b45">لا يمكن إنشاء رمز QR هنا — اضغطي لفتح الرابط على جهازك</p><div style="display:flex;gap:8px;justify-content:center"><input id="songLink" style="width:260px;padding:8px;border-radius:8px;border:1px solid #eee" readonly value="'+SONG_URL+'" /><button id="openLink" class="btn">فتح</button></div></div>';
				const openBtn = document.getElementById('openLink'); const linkInput = document.getElementById('songLink');
				if(openBtn){ openBtn.addEventListener('click', ()=>{ window.open(linkInput.value,'_blank'); }); }
			};
			// Initially hide envelope until QR acknowledged
			const cardWrap = document.querySelector('.card-wrap'); if(cardWrap) { cardWrap.style.opacity='0'; cardWrap.style.pointerEvents='none'; }
			qrDone.addEventListener('click', ()=>{ if(qrOverlay) qrOverlay.style.display='none'; if(cardWrap){ cardWrap.style.opacity='1'; cardWrap.style.pointerEvents='auto'; } });

			// No background audio controls in this mode; keep envelope interactive

			// no-op placeholder kept for compatibility
			window.setYouTubeBackground = function(){ console.warn('setYouTubeBackground disabled in QR mode'); };

		})();
	</script>

</body>
</html>
